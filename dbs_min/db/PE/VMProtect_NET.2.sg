function detect(){if(PE.isNet()&&3<=PE.getNumberOfSections()&&PE.isNetObjectPresent("SuppressIldasmAttribute")&&PE.isNetObjectPresent("kernel32")&&PE.isNetGlobalCctorPresent()){for(var e="%% %% %% %% %% %% %% %% 00",t=PE.getSize()-PE.getOverlaySize(),r="'<Module>'00",i="00",s=0;s<4;s++){r+=e
for(var n=0;n<2;n++)i+=e}var o=PE.section[0];-1==PE.findSignature(o.FileOffset,t,r)&&-1==PE.findSignature(o.FileOffset,t,i)||(sVersion="3.X",bDetected=!0),bDetected&&(PE.isSignaturePresent(o.FileOffset,t,generateUnicodeSignatureMask("Program will be terminated."))&&(sOptions="Resources protection"),".vmp"===(o=PE.getSectionNameCollision("0","1"))?sVersion="2.X-3.X":o&&(sOptions+=(0!=sOptions.length?" + ":"")+"Custom sections"),bDetected=bDetected&&!PE.isNetObjectPresent("VMProtect"))}return result()}function generateUnicodeSignatureMask(e){for(var t="",r=0;r<e.length;r++)t+=(0!=r?"00":"")+"'"+e[r]+"'"
return t}meta("protector","VMProtect")
